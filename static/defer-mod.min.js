/*! zachleat.com - v2.6.1 - 2022-12-22
* Copyright (c) 2022 Zach Leatherman; @license MIT License */
const islandOnceCache=new Map;class Island extends HTMLElement{static tagName="is-land";static prefix="is-land--";static attr={autoInitType:"autoinit",import:"import",template:"data-island",ready:"ready",defer:"defer-hydration"};static fallback={":not(:defined):not([defer-hydration])":(t,e,a)=>{let n=document.createElement(a+e.localName);for(let t of e.getAttributeNames())n.setAttribute(t,e.getAttribute(t));let i=e.shadowRoot;if(!i){let t=e.querySelector(":scope > template[shadowroot]");t&&(i=e.attachShadow({mode:"open"}),i.appendChild(t.content.cloneNode(!0)))}return i&&n.attachShadow({mode:i.mode}).append(...i.childNodes),n.append(...e.childNodes),e.replaceWith(n),t.then((()=>{n.shadowRoot&&e.shadowRoot.append(...n.shadowRoot.childNodes),e.append(...n.childNodes),n.replaceWith(e)}))}};static autoinit={"petite-vue":function(t){t.createApp().mount(this)},vue:function(t){t.createApp().mount(this)},svelte:function(t){new t.default({target:this})},"svelte-ssr":function(t){new t.default({target:this,hydrate:!0})},preact:function(t){t.default(this)}};constructor(){super(),this.ready=new Promise((t=>{this.readyResolve=t}))}static getParents(t,e=!1){let a=[];for(;t;){if(t.matches&&t.matches(Island.tagName)){if(e&&t===e)break;Conditions.hasConditions(t)&&a.push(t)}t=t.parentNode}return a}static async ready(t){let e=Island.getParents(t);if(0===e.length)return;let a=await Promise.all(e.map((t=>t.wait())));return a.length?a[0]:void 0}forceFallback(){window.Island&&Object.assign(Island.fallback,window.Island.fallback);for(let t in Island.fallback){let e=Array.from(this.querySelectorAll(t)).reverse();for(let a of e){if(!a.isConnected||a.localName===Island.tagName)continue;let e=Island.ready(a);Island.fallback[t](e,a,Island.prefix)}}}wait(){return this.ready}async connectedCallback(){Conditions.hasConditions(this)&&this.forceFallback(),await this.hydrate()}getTemplates(){return this.querySelectorAll(`template[${Island.attr.template}]`)}replaceTemplates(t){for(let e of t){if(Island.getParents(e,this).length>0)continue;let t=e.getAttribute(Island.attr.template);if("replace"===t){let t=Array.from(this.childNodes);for(let e of t)this.removeChild(e);this.appendChild(e.content);break}{let a=e.innerHTML;if("once"===t&&a){if(islandOnceCache.has(a))return void e.remove();islandOnceCache.set(a,!0)}e.replaceWith(e.content)}}}async hydrate(){let t=[];this.parentNode&&t.push(Island.ready(this.parentNode));let e,a=Conditions.getConditions(this);for(let e in a)Conditions.map[e]&&t.push(Conditions.map[e](a[e],this));await Promise.all(t),this.replaceTemplates(this.getTemplates());let n=this.getAttribute(Island.attr.import);if(n&&(e=await import(n)),e){let t=Island.autoinit[this.getAttribute(Island.attr.autoInitType)||n];t&&await t.call(this,e)}this.readyResolve({}),this.setAttribute(Island.attr.ready,""),this.querySelectorAll(`[${Island.attr.defer}]`).forEach((t=>t.removeAttribute(Island.attr.defer)))}}class Conditions{static map={visible:Conditions.visible,idle:Conditions.idle,interaction:Conditions.interaction,media:Conditions.media,"save-data":Conditions.saveData};static hasConditions(t){return Object.keys(Conditions.getConditions(t)).length>0}static getConditions(t){let e={};for(let a of Object.keys(Conditions.map))t.hasAttribute(`on:${a}`)&&(e[a]=t.getAttribute(`on:${a}`));return e}static visible(t,e){if("IntersectionObserver"in window)return new Promise((t=>{let a=new IntersectionObserver((e=>{let[n]=e;n.isIntersecting&&(a.unobserve(n.target),t())}));a.observe(e)}))}static idle(){let t=new Promise((t=>{"complete"!==document.readyState?window.addEventListener("load",(()=>t()),{once:!0}):t()}));return"requestIdleCallback"in window?Promise.all([new Promise((t=>{requestIdleCallback((()=>{t()}))})),t]):t}static interaction(t,e){let a=["click","touchstart"];return t&&(a=(t||"").split(",").map((t=>t.trim()))),new Promise((t=>{function n(i){t();for(let t of a)e.removeEventListener(t,n)}for(let t of a)e.addEventListener(t,n,{once:!0})}))}static media(t){let e={matches:!0};if(t&&"matchMedia"in window&&(e=window.matchMedia(t)),!e.matches)return new Promise((t=>{e.addListener((e=>{e.matches&&t()}))}))}static saveData(t){return"connection"in navigator&&navigator.connection.saveData!==("false"!==t)?new Promise((()=>{})):Promise.resolve()}}"customElements"in window&&(window.customElements.define(Island.tagName,Island),window.Island=Island);export const component=Island;export const ready=Island.ready;